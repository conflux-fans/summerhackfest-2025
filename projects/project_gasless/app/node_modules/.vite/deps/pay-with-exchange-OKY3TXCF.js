import "./chunk-42B64YFO.js";
import "./chunk-6AQTJEUX.js";
import "./chunk-TUNDUU3K.js";
import "./chunk-I4MM7BTF.js";
import "./chunk-QHB7LYGY.js";
import "./chunk-L2OUNEUE.js";
import "./chunk-HNB35IZC.js";
import "./chunk-CZODAATX.js";
import "./chunk-LD4QFRZW.js";
import "./chunk-EMO2K4TS.js";
import "./chunk-FS3CSUOV.js";
import "./chunk-STLMS27B.js";
import "./chunk-UDKKWMJR.js";
import "./chunk-YRZXNN53.js";
import "./chunk-CGXHVTOC.js";
import "./chunk-Y3PBWOOE.js";
import "./chunk-BPOUVDTE.js";
import "./chunk-YUWHXTCR.js";
import "./chunk-3JEQUCFW.js";
import "./chunk-PUESNEOF.js";
import {
  state
} from "./chunk-UTDSGB3M.js";
import {
  ExchangeController,
  css,
  customElement
} from "./chunk-UM4EL2C6.js";
import "./chunk-JD3L7WOJ.js";
import {
  LitElement,
  html
} from "./chunk-JOZS27JW.js";
import "./chunk-AL7AZVTW.js";
import "./chunk-ANJCMEYS.js";
import "./chunk-SPJEADIR.js";
import "./chunk-PBCTZGBJ.js";
import "./chunk-42QRY2Q5.js";
import "./chunk-6GOASCKB.js";
import {
  AccountController,
  ChainController,
  ConnectionController,
  CoreHelperUtil,
  RouterController,
  SnackController
} from "./chunk-P67RJMFF.js";
import "./chunk-D3R4SLAY.js";
import "./chunk-RP3AHXCJ.js";
import "./chunk-5VQ5XVOV.js";
import "./chunk-LEH2ZZ7D.js";
import "./chunk-NP5FVCBD.js";
import "./chunk-64NT3AJW.js";

// node_modules/@reown/appkit-scaffold-ui/dist/esm/src/views/w3m-deposit-from-exchange-view/styles.js
var styles_default = css`
  .amount-input-container {
    border-radius: ${({ borderRadius }) => borderRadius["5"]};
    border-top-right-radius: 0;
    border-top-left-radius: 0;
    border-bottom: 1px solid ${({ tokens }) => tokens.core.glass010};
    background-color: ${({ tokens }) => tokens.theme.backgroundPrimary};
  }

  .container {
    background-color: ${({ tokens }) => tokens.theme.foregroundSecondary};
    border-radius: 30px;
  }
`;

// node_modules/@reown/appkit-scaffold-ui/dist/esm/src/views/w3m-deposit-from-exchange-view/index.js
var __decorate = function(decorators, target, key, desc) {
  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var PRESET_AMOUNTS = [10, 50, 100];
var W3mDepositFromExchangeView = class W3mDepositFromExchangeView2 extends LitElement {
  constructor() {
    super();
    this.unsubscribe = [];
    this.network = ChainController.state.activeCaipNetwork;
    this.exchanges = ExchangeController.state.exchanges;
    this.isLoading = ExchangeController.state.isLoading;
    this.amount = ExchangeController.state.amount;
    this.tokenAmount = ExchangeController.state.tokenAmount;
    this.priceLoading = ExchangeController.state.priceLoading;
    this.isPaymentInProgress = ExchangeController.state.isPaymentInProgress;
    this.currentPayment = ExchangeController.state.currentPayment;
    this.paymentId = ExchangeController.state.paymentId;
    this.paymentAsset = ExchangeController.state.paymentAsset;
    this.unsubscribe.push(ChainController.subscribeKey("activeCaipNetwork", (val) => {
      this.network = val;
      this.setDefaultPaymentAsset();
    }), ExchangeController.subscribe((exchangeState) => {
      var _a, _b;
      this.exchanges = exchangeState.exchanges;
      this.isLoading = exchangeState.isLoading;
      this.amount = exchangeState.amount;
      this.tokenAmount = exchangeState.tokenAmount;
      this.priceLoading = exchangeState.priceLoading;
      this.paymentId = exchangeState.paymentId;
      this.isPaymentInProgress = exchangeState.isPaymentInProgress;
      this.currentPayment = exchangeState.currentPayment;
      this.paymentAsset = exchangeState.paymentAsset;
      const shouldHandlePaymentInProgress = exchangeState.isPaymentInProgress && ((_a = exchangeState.currentPayment) == null ? void 0 : _a.exchangeId) && ((_b = exchangeState.currentPayment) == null ? void 0 : _b.sessionId) && exchangeState.paymentId;
      if (shouldHandlePaymentInProgress) {
        this.handlePaymentInProgress();
      }
    }));
  }
  disconnectedCallback() {
    this.unsubscribe.forEach((unsubscribe) => unsubscribe());
    ExchangeController.reset();
  }
  async firstUpdated() {
    await this.getPaymentAssets();
    if (!this.paymentAsset) {
      await this.setDefaultPaymentAsset();
    }
    await ExchangeController.fetchExchanges();
  }
  render() {
    return html`
      <wui-flex flexDirection="column" gap="2" class="container">
        ${this.amountInputTemplate()} ${this.exchangesTemplate()}
      </wui-flex>
    `;
  }
  exchangesLoadingTemplate() {
    return Array.from({ length: 2 }).map(() => html`<wui-shimmer width="100%" height="65px" borderRadius="xxs"></wui-shimmer>`);
  }
  _exchangesTemplate() {
    return this.exchanges.length > 0 ? this.exchanges.map((exchange) => html`<wui-list-item
              @click=${() => this.onExchangeClick(exchange)}
              chevron
              variant="image"
              imageSrc=${exchange.imageUrl}
              ?loading=${this.isLoading}
            >
              <wui-text variant="md-regular" color="secondary">
                Deposit from ${exchange.name}
              </wui-text>
            </wui-list-item>`) : html`<wui-flex flexDirection="column" alignItems="center" gap="4" padding="4">
          <wui-text variant="lg-medium" align="center" color="primary">
            No exchanges support this asset on this network
          </wui-text>
        </wui-flex>`;
  }
  exchangesTemplate() {
    return html`<wui-flex
      flexDirection="column"
      gap="2"
      .padding=${["3", "3", "3", "3"]}
      class="exchanges-container"
    >
      ${this.isLoading ? this.exchangesLoadingTemplate() : this._exchangesTemplate()}
    </wui-flex>`;
  }
  amountInputTemplate() {
    var _a, _b;
    return html`
      <wui-flex flexDirection="column" gap="3" .padding=${["0", "3", "3", "3"]} class="amount-input-container">
        <wui-flex justifyContent="space-between" alignItems="center">
          <wui-text variant="md-medium" color="secondary">Asset</wui-text>

          <wui-token-button
            data-testid="deposit-from-exchange-asset-button"
            flexDirection="row-reverse"
            text=${((_a = this.paymentAsset) == null ? void 0 : _a.metadata.symbol) || ""}
            imageSrc=${((_b = this.paymentAsset) == null ? void 0 : _b.metadata.iconUrl) || ""}
            @click=${() => RouterController.push("PayWithExchangeSelectAsset")}
            >
          </wui-token-button>
        </wui-flex>
        <wui-flex flexDirection="column" alignItems="center" justifyContent="center">
          <wui-flex alignItems="center" gap="1">
            <wui-text variant="h2-regular" color="secondary">${this.amount}</wui-text>
            <wui-text variant="md-regular" color="secondary">USD</wui-text>
          </wui-flex>
          ${this.tokenAmountTemplate()}
          </wui-flex>
          <wui-flex justifyContent="space-between" gap="2">
            ${PRESET_AMOUNTS.map((amount) => html`<wui-button @click=${() => this.onPresetAmountClick(amount)} variant=${this.amount === amount ? "neutral-primary" : "neutral-secondary"} size="sm" fullWidth>$${amount}</wui-button>`)}
          </wui-flex>
        </wui-flex>
      </wui-flex>
    `;
  }
  tokenAmountTemplate() {
    var _a;
    if (this.priceLoading) {
      return html`<wui-shimmer
        width="65px"
        height="20px"
        borderRadius="xxs"
        variant="light"
      ></wui-shimmer>`;
    }
    return html`
      <wui-text variant="md-regular" color="secondary">
        ${this.tokenAmount.toFixed(4)} ${(_a = this.paymentAsset) == null ? void 0 : _a.metadata.symbol}
      </wui-text>
    `;
  }
  async onExchangeClick(exchange) {
    if (!this.amount) {
      SnackController.showError("Please enter an amount");
      return;
    }
    await ExchangeController.handlePayWithExchange(exchange.id);
  }
  handlePaymentInProgress() {
    var _a, _b;
    const namespace = ChainController.state.activeChain;
    if (this.isPaymentInProgress && ((_a = this.currentPayment) == null ? void 0 : _a.exchangeId) && ((_b = this.currentPayment) == null ? void 0 : _b.sessionId) && this.paymentId) {
      ExchangeController.waitUntilComplete({
        exchangeId: this.currentPayment.exchangeId,
        sessionId: this.currentPayment.sessionId,
        paymentId: this.paymentId
      }).then((status) => {
        if (status.status === "SUCCESS") {
          SnackController.showSuccess("Deposit completed");
          if (namespace) {
            AccountController.fetchTokenBalance();
            ConnectionController.updateBalance(namespace);
          }
        } else if (status.status === "FAILED") {
          SnackController.showError("Deposit failed");
        }
      });
      SnackController.showLoading("Deposit in progress...");
      RouterController.replace("Account");
    }
  }
  onPresetAmountClick(amount) {
    ExchangeController.setAmount(amount);
  }
  async getPaymentAssets() {
    if (this.network) {
      await ExchangeController.getAssetsForNetwork(this.network.caipNetworkId);
    }
  }
  async setDefaultPaymentAsset() {
    if (this.network) {
      const paymentAssets = await ExchangeController.getAssetsForNetwork(this.network.caipNetworkId);
      if (paymentAssets[0]) {
        ExchangeController.setPaymentAsset(paymentAssets[0]);
      }
    }
  }
};
W3mDepositFromExchangeView.styles = styles_default;
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "network", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "exchanges", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "isLoading", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "amount", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "tokenAmount", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "priceLoading", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "isPaymentInProgress", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "currentPayment", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "paymentId", void 0);
__decorate([
  state()
], W3mDepositFromExchangeView.prototype, "paymentAsset", void 0);
W3mDepositFromExchangeView = __decorate([
  customElement("w3m-deposit-from-exchange-view")
], W3mDepositFromExchangeView);

// node_modules/@reown/appkit-scaffold-ui/dist/esm/src/views/w3m-deposit-from-exchange-select-asset-view/styles.js
var styles_default2 = css`
  .contentContainer {
    height: 440px;
    overflow: scroll;
    scrollbar-width: none;
  }

  .contentContainer::-webkit-scrollbar {
    display: none;
  }

  wui-icon-box {
    width: 40px;
    height: 40px;
    border-radius: ${({ borderRadius }) => borderRadius["3"]};
  }
`;

// node_modules/@reown/appkit-scaffold-ui/dist/esm/src/views/w3m-deposit-from-exchange-select-asset-view/index.js
var __decorate2 = function(decorators, target, key, desc) {
  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};
var W3mDepositFromExchangeSelectAssetView = class W3mDepositFromExchangeSelectAssetView2 extends LitElement {
  constructor() {
    super();
    this.unsubscribe = [];
    this.assets = ExchangeController.state.assets;
    this.search = "";
    this.onDebouncedSearch = CoreHelperUtil.debounce((value) => {
      this.search = value;
    });
    this.unsubscribe.push(...[
      ExchangeController.subscribe((val) => {
        this.assets = val.assets;
      })
    ]);
  }
  disconnectedCallback() {
    this.unsubscribe.forEach((unsubscribe) => unsubscribe());
  }
  render() {
    return html`
      <wui-flex flexDirection="column">
        ${this.templateSearchInput()} <wui-separator></wui-separator> ${this.templateTokens()}
      </wui-flex>
    `;
  }
  templateSearchInput() {
    return html`
      <wui-flex gap="2" padding="3">
        <wui-input-text
          @inputChange=${this.onInputChange.bind(this)}
          class="network-search-input"
          size="sm"
          placeholder="Search token"
          icon="search"
        ></wui-input-text>
      </wui-flex>
    `;
  }
  templateTokens() {
    const filteredAssets = this.assets.filter((asset) => asset.metadata.name.toLowerCase().includes(this.search.toLowerCase()));
    const hasAssets = filteredAssets.length > 0;
    return html`
      <wui-flex
        class="contentContainer"
        flexDirection="column"
        .padding=${["0", "3", "0", "3"]}
      >
        <wui-flex justifyContent="flex-start" .padding=${["4", "3", "3", "3"]}>
          <wui-text variant="md-medium" color="secondary">Available tokens</wui-text>
        </wui-flex>
        <wui-flex flexDirection="column" gap="2">
          ${hasAssets ? filteredAssets.map((asset) => html`<wui-list-item
                    .imageSrc=${asset.metadata.iconUrl}
                    ?clickable=${true}
                    @click=${this.handleTokenClick.bind(this, asset)}
                  >
                    <wui-text variant="md-medium" color="primary">${asset.metadata.name}</wui-text>
                    <wui-text variant="md-regular" color="secondary"
                      >${asset.metadata.symbol}</wui-text
                    >
                  </wui-list-item>`) : html`<wui-flex
                .padding=${["20", "0", "0", "0"]}
                alignItems="center"
                flexDirection="column"
                gap="4"
              >
                <wui-icon-box icon="coinPlaceholder" color="default" size="lg"></wui-icon-box>
                <wui-flex
                  class="textContent"
                  gap="2"
                  flexDirection="column"
                  justifyContent="center"
                >
                  <wui-text variant="lg-medium" align="center" color="primary">
                    No tokens found
                  </wui-text>
                </wui-flex>
                <wui-link @click=${this.onBuyClick.bind(this)}>Buy</wui-link>
              </wui-flex>`}
        </wui-flex>
      </wui-flex>
    `;
  }
  onBuyClick() {
    RouterController.push("OnRampProviders");
  }
  onInputChange(event) {
    this.onDebouncedSearch(event.detail);
  }
  handleTokenClick(asset) {
    ExchangeController.setPaymentAsset(asset);
    RouterController.goBack();
  }
};
W3mDepositFromExchangeSelectAssetView.styles = styles_default2;
__decorate2([
  state()
], W3mDepositFromExchangeSelectAssetView.prototype, "assets", void 0);
__decorate2([
  state()
], W3mDepositFromExchangeSelectAssetView.prototype, "search", void 0);
W3mDepositFromExchangeSelectAssetView = __decorate2([
  customElement("w3m-deposit-from-exchange-select-asset-view")
], W3mDepositFromExchangeSelectAssetView);
export {
  W3mDepositFromExchangeSelectAssetView,
  W3mDepositFromExchangeView
};
//# sourceMappingURL=pay-with-exchange-OKY3TXCF.js.map
